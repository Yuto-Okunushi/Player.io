<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ÂãïÁâ©„Éú„Çø„É≥„ÅßAWS WebSocketÈÄö‰ø°</title>
  <style>
    body {
        margin: 0;
        padding: 0;
        background-image: url('18.png');
        background-size: 100% 100%;
        background-position: center;
        background-repeat: no-repeat;
        font-family: sans-serif;
        display: flex;
        justify-content: center;
        align-items: flex-end;
        height: 100vh;
        position: relative;
        overflow: hidden;
    }

    .headline {
        position: absolute;
        top: 40%;
        left: 50%;
        display: none;
        transform: translateX(-50%);
        color: #fff;
        font-size: 1.4rem;
        text-align: center;
        text-shadow: 0 0 5px #5c5045;
        font-weight: bold;
        white-space: nowrap;
        max-width: 100vw;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .animal-info {
        position: absolute;
        top: 5vh;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        color: white;
        text-shadow: 0 0 5px #4b463e;
        max-width: 90vw;
        font-size: 4.5vw;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .animal-info .title {
        font-size: 5.5vw;
        font-weight: bold;
    }

    .animal-info .description {
        font-size: 3.5vw;
        margin-top: 0.5vh;
    }

    .animal-image {
        width: 40vw;
        max-width: 200px;
        height: auto;
        margin-top: 1vh;
    }

    @media (min-width: 768px) {
        .animal-info .title {
            font-size: 2rem;
        }

        .animal-info .description {
            font-size: 1.2rem;
        }

        .animal-image {
            width: 150px;
        }
    }

    .card-container {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        margin-bottom: 2rem;
        align-items: flex-end;
    }

    .card-button {
        width: 90vw;
        max-width: 400px;
        height: auto;
        position: relative;
        padding: 0;
        margin: 0;
        border: none;
        background: none;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 2.0rem;
    }

    .card-button img {
        display: block;
        width: 50%;
        height: 50%;
        transition: transform 0.3s ease, filter 0.3s ease;
    }

    .card-button:hover img {
        transform: scale(1.05);
        filter: brightness(1.1);
    }

    .card-label {
        position: absolute;
        top: 60%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #280508;
        font-weight: bold;
        pointer-events: none;
        user-select: none;
        font-size: 50%;
        transition: transform 0.3s ease, filter 0.3s ease;
    }

    .card-button:hover .card-label {
        transform: translate(-50%, -50%) scale(1.05);
        filter: brightness(1.1);
    }

    .card-button.disabled {
        opacity: 0.3;
        pointer-events: none;
    }

    .confirmation-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
    }

    .confirmation-content {
        background: #ede6d0;
        padding: 2rem;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        max-width: 90vw;
    }

    .confirmation-text {
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
        color: #333;
    }

    .confirmation-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
    }

    .confirm-btn, .cancel-btn {
        padding: 0.8rem 2rem;
        font-size: 1.2rem;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .confirm-btn {
        background: #88b04b;
        color: white;
    }

    .cancel-btn {
        background: #a93f2c;
        color: white;
    }

    .overlay {
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background-image: url('17.png');
        background-repeat: repeat;
        background-size: 1500px auto;
        transform: rotate(45deg);
        opacity: 0.2;
        animation: diagonalScroll 40s linear infinite;
        pointer-events: none;
        z-index: 0;
    }

    @keyframes diagonalScroll {
        0% { background-position: 0 0; }
        100% { background-position: 100% 200%; }
    }

    .status-message {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 1.8rem;
        text-shadow: 0 0 5px #4b463e;
        white-space: nowrap;
    }
  </style>
</head>
<body>

  <div class="overlay"></div>

  <div class="animal-info">
    <div class="title">„ÅÇ„Å™„Åü„ÅØ</div>
    <div class="title">„Ç´„Éê</div>
    <div class="description">Ê∞¥Ëæ∫„Å´‰Ωè„ÇÄÂ§ß„Åç„Å™ÂãïÁâ©„Åß„Åô„ÄÇ</div>
    <img src="CH_kaba_ver001.png" alt="„Ç´„ÉêÁîªÂÉè" class="animal-image" />
  </div>

  <div id="headline" class="headline">Ë≠∞Ë´ñ„Åß‰Ωï„Çí„Åô„ÇãÔºü</div>
  <div id="status-message" class="status-message">„Çπ„Éà„Éº„É™„ÉºÈÄ≤Ë°å‰∏≠</div>

  <div class="card-container" style="display: none;">
    <button class="card-button" onclick="showConfirmation(1, 'Ë©±„Çí„Åæ„Å®„ÇÅ„Çã')">
      <img src="UI_BG_useroptionday_ver001.png" />
      <span class="card-label">Ë©±„Çí„Åæ„Å®„ÇÅ„Çã</span>
    </button>
    <button class="card-button" onclick="showConfirmation(2, 'ÊÑèË¶ã„ÇíË®Ä„ÅÜ')">
      <img src="UI_BG_useroptionday_ver001.png" />
      <span class="card-label">ÊÑèË¶ã„ÇíË®Ä„ÅÜ</span>
    </button>
    <button class="card-button" onclick="showConfirmation(3, '„ÇÑ„Çã„Åπ„Åç„Åì„Å®„Çí‰∏ªÂºµ„Åô„Çã')">
      <img src="UI_BG_useroptionday_ver001.png" />
      <span class="card-label">„ÇÑ„Çã„Åπ„Åç„Åì„Å®„Çí‰∏ªÂºµ„Åô„Çã</span>
    </button>
    <button class="card-button" onclick="showConfirmation(4, '„ÅîÈ£Ø„ÇíÈ£ü„Åπ„Çã')">
      <img src="UI_BG_useroptionday_ver001.png" />
      <span class="card-label">„ÅîÈ£Ø„ÇíÈ£ü„Åπ„Çã</span>
    </button>
  </div>

  <div id="confirmation-modal" class="confirmation-modal">
    <div class="confirmation-content">
      <div class="confirmation-text">„Åì„Çå„ÅßÊ±∫ÂÆö„Åô„ÇãÔºü</div>
      <div class="confirmation-buttons">
        <button class="confirm-btn" onclick="confirmAction()">Ê±∫ÂÆö</button>
        <button class="cancel-btn" onclick="cancelAction()">„Ç≠„É£„É≥„Çª„É´</button>
      </div>
    </div>
  </div>

  <script>
    let socket = new WebSocket("wss://ws.dcsaitolab.com"); // ‚Üê Êú¨Áï™Áî®WebSocket„Ç¢„Éâ„É¨„Çπ
    let currentAnimalId = 1;
    let selectedActionId = null;

    const animals = {
        1: { name: "„Ç´„Éê", description: "Ê∞¥Ëæ∫„Å´‰Ωè„ÇÄÂ§ß„Åç„Å™ÂãïÁâ©„Åß„Åô„ÄÇ", image: "CH_kaba_ver001.png" },
        2: { name: "„Ç¶„Çµ„ÇÆ", description: "„Å¥„Çá„Çì„Å¥„Çá„ÇìË∑≥„Å≠„ÇãÂèØÊÑõ„ÅÑÂãïÁâ©„Åß„Åô„ÄÇ", image: "CH_usagi_ver001.png" },
        3: { name: "„É¢„É¢„É≥„Ç¨", description: "ÊªëÁ©∫„Åô„ÇãÂ§úË°åÊÄß„ÅÆÂãïÁâ©„Åß„Åô„ÄÇ", image: "CH_momonga_ver001.png" },
        4: { name: "„Éã„Éõ„É≥„Ç∂„É´", description: "Ê∏©Ê≥â„Å´ÂÖ•„Çã„Åì„Å®„ÅßÊúâÂêç„Åß„Åô„ÄÇ", image: "CH_saru_ver001.png" },
    };

    const statusMessage = document.getElementById("status-message");
    const cardContainer = document.querySelector(".card-container");
    const headline = document.getElementById("headline");
    const confirmationModal = document.getElementById("confirmation-modal");

    let dotState = 0;
    let loadingText = "„Çπ„Éà„Éº„É™„ÉºÈÄ≤Ë°å‰∏≠";
    setInterval(() => {
        dotState = (dotState + 1) % 4;
        statusMessage.textContent = loadingText + ".".repeat(dotState);
    }, 500);

    socket.onopen = () => console.log("‚úÖ Êé•Á∂öÂÆå‰∫Ü");
    socket.onerror = (e) => console.error("‚ùå „Ç®„É©„Éº:", e);

    socket.onmessage = (e) => {
        console.log("üì© Âèó‰ø°:", e.data);
        const value = e.data.trim();

        if (!isNaN(value) && animals[parseInt(value)]) {
            const id = parseInt(value);
            currentAnimalId = id;
            document.querySelectorAll(".animal-info .title")[1].textContent = animals[id].name;
            document.querySelector(".animal-info .description").textContent = animals[id].description;
            document.querySelector(".animal-image").src = animals[id].image;
        }

        if (value === "start") {
            cardContainer.style.display = "flex";
            statusMessage.style.display = "none";
            headline.style.display = "block";
            headline.textContent = "Ë≠∞Ë´ñ„Åß‰Ωï„Çí„Åô„ÇãÔºü";
            document.querySelectorAll('.card-button').forEach(btn => btn.classList.remove('disabled'));
        } else if (value === "discuss") {
            loadingText = "Ë≠∞Ë´ñ‰∏≠";
            cardContainer.style.display = "none";
            statusMessage.style.display = "block";
            headline.style.display = "none";
        } else if (value === "wait") {
            loadingText = "„Çπ„Éà„Éº„É™„ÉºÈÄ≤Ë°å‰∏≠";
            cardContainer.style.display = "none";
            statusMessage.style.display = "block";
            headline.style.display = "none";
        }
    };

    function showConfirmation(actionId, actionName) {
        selectedActionId = actionId;
        confirmationModal.style.display = "flex";
    }

    function confirmAction() {
        if (selectedActionId !== null) {
            socket.send(selectedActionId.toString());
            document.querySelectorAll('.card-button').forEach(btn => btn.classList.add('disabled'));
            headline.textContent = "ÂæÖÊ©ü‰∏≠...";
            confirmationModal.style.display = "none";
        }
    }

    function cancelAction() {
        selectedActionId = null;
        confirmationModal.style.display = "none";
    }
  </script>
</body>
</html>
